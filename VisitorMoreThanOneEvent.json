{"paragraphs":[{"text":"%spark2.pyspark\n### Recommender system for frequency of users's event more than one on Ecommerce data\n# events data\nevents = spark.read.options(header=True, inferSchema=True).csv('/user/capstone/events.csv')","user":"anonymous","dateUpdated":"2018-07-31T00:01:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532818353586_120341538","id":"20180728-225233_1592630379","dateCreated":"2018-07-28T22:52:33+0000","dateStarted":"2018-07-31T00:01:40+0000","dateFinished":"2018-07-31T00:01:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:28525"},{"text":"%spark2.pyspark\n# group by user\nvisitorGroupBy = events.groupBy('visitorid').count()","user":"anonymous","dateUpdated":"2018-07-31T00:01:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532818593876_718178387","id":"20180728-225633_1158112561","dateCreated":"2018-07-28T22:56:33+0000","dateStarted":"2018-07-31T00:01:47+0000","dateFinished":"2018-07-31T00:01:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28526"},{"text":"%spark2.pyspark\n# select users who has more than a event\nvisitorGt1 = visitorGroupBy.filter(visitorGroupBy['count']>1)","user":"anonymous","dateUpdated":"2018-07-31T00:01:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532818647221_1944616674","id":"20180728-225727_647497027","dateCreated":"2018-07-28T22:57:27+0000","dateStarted":"2018-07-31T00:01:50+0000","dateFinished":"2018-07-31T00:01:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28527"},{"text":"%spark2.pyspark\n# Join the visitorGt1 with events on visiterid\neventsJoinVisitorGt1 = events.join(visitorGt1, ['visitorid'])\n","user":"anonymous","dateUpdated":"2018-07-31T00:01:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532818726643_-799504426","id":"20180728-225846_281969543","dateCreated":"2018-07-28T22:58:46+0000","dateStarted":"2018-07-31T00:01:53+0000","dateFinished":"2018-07-31T00:01:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28528"},{"text":"%spark2.pyspark\n# Select distinct values to avoid redundents\neventsJoinVisitorGt1Distinct = eventsJoinVisitorGt1.distinct()\n","user":"anonymous","dateUpdated":"2018-07-31T00:02:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532818753215_319222782","id":"20180728-225913_1346337612","dateCreated":"2018-07-28T22:59:13+0000","dateStarted":"2018-07-31T00:02:02+0000","dateFinished":"2018-07-31T00:02:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28529"},{"text":"%spark2.pyspark\n\neventsJoinVisitorGt1Distinct.count()","user":"anonymous","dateUpdated":"2018-07-30T17:57:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1754081\n"}]},"apps":[],"jobName":"paragraph_1532819632642_-523717207","id":"20180728-231352_496001712","dateCreated":"2018-07-28T23:13:52+0000","dateStarted":"2018-07-28T23:14:24+0000","dateFinished":"2018-07-28T23:15:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28530"},{"text":"%spark2.pyspark\n# Assign the values to each event\nviewreplace = eventsJoinVisitorGt1Distinct.replace({'view':'1'})\n","user":"anonymous","dateUpdated":"2018-07-31T00:02:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819076179_-51443127","id":"20180728-230436_1078749668","dateCreated":"2018-07-28T23:04:36+0000","dateStarted":"2018-07-31T00:02:11+0000","dateFinished":"2018-07-31T00:02:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28531"},{"text":"%spark2.pyspark\n\naddtocartreplace = viewreplace.replace({'addtocart':'2'})\n","user":"anonymous","dateUpdated":"2018-07-31T00:02:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819555992_1264687626","id":"20180728-231235_414888532","dateCreated":"2018-07-28T23:12:35+0000","dateStarted":"2018-07-31T00:02:13+0000","dateFinished":"2018-07-31T00:02:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28532"},{"text":"%spark2.pyspark\n\nfinal = addtocartreplace.replace({'transaction':'3'})\n","user":"anonymous","dateUpdated":"2018-07-31T00:02:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819552552_-1187732511","id":"20180728-231232_125734142","dateCreated":"2018-07-28T23:12:32+0000","dateStarted":"2018-07-31T00:02:17+0000","dateFinished":"2018-07-31T00:02:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28533"},{"text":"%spark2.pyspark\nfinal.show(5)","user":"anonymous","dateUpdated":"2018-07-28T23:15:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-------------+-----+------+-------------+-----+\n|visitorid|    timestamp|event|itemid|transactionid|count|\n+---------+-------------+-----+------+-------------+-----+\n|      496|1438745738297|    1|269803|         null|    2|\n|      496|1439922144484|    1|395920|         null|    2|\n|     1238|1438970280581|    1| 76426|         null|    3|\n|     1238|1438970177401|    1| 76426|         null|    3|\n|     1238|1438967704727|    1| 76426|         null|    3|\n+---------+-------------+-----+------+-------------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532819267067_-1794696065","id":"20180728-230747_1331559266","dateCreated":"2018-07-28T23:07:47+0000","dateStarted":"2018-07-28T23:15:56+0000","dateFinished":"2018-07-28T23:16:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28534"},{"text":"%spark2.pyspark\n# Extract the columns for MatrixFactorization with distinct timestamp \n\ndata = final['visitorid','itemid','event']\n\n","user":"anonymous","dateUpdated":"2018-07-31T00:02:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819393148_-138135867","id":"20180728-230953_561790893","dateCreated":"2018-07-28T23:09:53+0000","dateStarted":"2018-07-31T00:02:24+0000","dateFinished":"2018-07-31T00:02:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28535"},{"text":"%spark2.pyspark\ndata.show(5)","user":"anonymous","dateUpdated":"2018-07-28T23:16:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+------+-----+\n|visitorid|itemid|event|\n+---------+------+-----+\n|      496|269803|    1|\n|      496|395920|    1|\n|     1238| 76426|    1|\n|     1238| 76426|    1|\n|     1238| 76426|    1|\n+---------+------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532819727465_1823940672","id":"20180728-231527_864754339","dateCreated":"2018-07-28T23:15:27+0000","dateStarted":"2018-07-28T23:16:30+0000","dateFinished":"2018-07-28T23:16:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28536"},{"text":"%spark2.pyspark\n#  Save the data file into hdfs\n\ndata.coalesce(1).write.option('header','true').csv('/user/maria_dev/CountWiseVisitorTime.csv')","user":"anonymous","dateUpdated":"2018-07-31T00:02:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819517549_-1268391863","id":"20180728-231157_55984759","dateCreated":"2018-07-28T23:11:57+0000","dateStarted":"2018-07-31T00:02:58+0000","dateFinished":"2018-07-31T00:03:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28537"},{"text":"%spark2.pyspark\n# Creating RDD file\ndataCountWise = sc.textFile('/user/maria_dev/CountWiseVisitorTime.csv')\n\ntype(data)","user":"anonymous","dateUpdated":"2018-07-31T00:03:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.sql.dataframe.DataFrame'>\n"}]},"apps":[],"jobName":"paragraph_1532819696508_-1660021915","id":"20180728-231456_704685480","dateCreated":"2018-07-28T23:14:56+0000","dateStarted":"2018-07-31T00:03:06+0000","dateFinished":"2018-07-31T00:03:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28538"},{"text":"%spark2.pyspark\nheader=dataCountWise.first()","user":"anonymous","dateUpdated":"2018-07-31T00:03:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819806724_-392873577","id":"20180728-231646_1112878204","dateCreated":"2018-07-28T23:16:46+0000","dateStarted":"2018-07-31T00:03:35+0000","dateFinished":"2018-07-31T00:03:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28539"},{"text":"%spark2.pyspark\ndataWithNoHeader = dataCountWise.filter(lambda x: x!=header)\n","user":"anonymous","dateUpdated":"2018-07-31T00:03:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819891528_-7016402","id":"20180728-231811_1136839655","dateCreated":"2018-07-28T23:18:11+0000","dateStarted":"2018-07-31T00:03:36+0000","dateFinished":"2018-07-31T00:03:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28540"},{"text":"%spark2.pyspark\ndataWithNoHeader.first()\n","user":"anonymous","dateUpdated":"2018-07-28T23:21:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'496,269803,1'\n"}]},"apps":[],"jobName":"paragraph_1532820093264_662703382","id":"20180728-232133_180828303","dateCreated":"2018-07-28T23:21:33+0000","dateStarted":"2018-07-28T23:21:41+0000","dateFinished":"2018-07-28T23:21:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28541"},{"text":"%spark2.pyspark\n# Load ALS module, MatrixFactorizationModel, Rating\n\nfrom pyspark.mllib.recommendation import ALS, MatrixFactorizationModel, Rating\n\nCountRating = dataWithNoHeader.map(lambda x: x.split(','))\\\n.map(lambda x: Rating(int(x[0]), int(x[1]), float(x[2])))","user":"anonymous","dateUpdated":"2018-07-31T00:03:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532820101616_1842743583","id":"20180728-232141_969569491","dateCreated":"2018-07-28T23:21:41+0000","dateStarted":"2018-07-31T00:03:36+0000","dateFinished":"2018-07-31T00:03:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28542"},{"text":"%spark2.pyspark\ntype(CountRating)","user":"anonymous","dateUpdated":"2018-07-28T23:29:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n"}]},"apps":[],"jobName":"paragraph_1532820122051_-592301557","id":"20180728-232202_2113268056","dateCreated":"2018-07-28T23:22:02+0000","dateStarted":"2018-07-28T23:29:47+0000","dateFinished":"2018-07-28T23:29:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28543"},{"text":"%spark2.pyspark\ndf = sqlContext.createDataFrame(CountRating)\n","user":"anonymous","dateUpdated":"2018-07-31T00:03:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532820133373_-176556562","id":"20180728-232213_328956731","dateCreated":"2018-07-28T23:22:13+0000","dateStarted":"2018-07-31T00:03:37+0000","dateFinished":"2018-07-31T00:03:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28544"},{"text":"%spark2.pyspark\ndf.count()","user":"anonymous","dateUpdated":"2018-07-28T23:32:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1754081\n"}]},"apps":[],"jobName":"paragraph_1532820619919_-645861564","id":"20180728-233019_193966343","dateCreated":"2018-07-28T23:30:19+0000","dateStarted":"2018-07-28T23:32:23+0000","dateFinished":"2018-07-28T23:33:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28545"},{"text":"%spark2.pyspark\n# # Data exploration on CountVisitor\n# Distinct Users\n\ndf.select('user').distinct().show(5)\n","user":"anonymous","dateUpdated":"2018-07-28T23:34:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+\n|  user|\n+------+\n| 15846|\n|160820|\n|342088|\n|652700|\n|703028|\n+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532820743645_1422700120","id":"20180728-233223_979417442","dateCreated":"2018-07-28T23:32:23+0000","dateStarted":"2018-07-28T23:34:03+0000","dateFinished":"2018-07-28T23:34:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28546"},{"text":"%spark2.pyspark\n# Distinct Users's count\n\ndf.select('user').distinct().count()","user":"anonymous","dateUpdated":"2018-07-28T23:35:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"406020\n"}]},"apps":[],"jobName":"paragraph_1532820817669_1786211209","id":"20180728-233337_113725978","dateCreated":"2018-07-28T23:33:37+0000","dateStarted":"2018-07-28T23:35:09+0000","dateFinished":"2018-07-28T23:36:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28547"},{"text":"%spark2.pyspark\ndf.select('product').distinct().show(5)","user":"anonymous","dateUpdated":"2018-07-28T23:36:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n|product|\n+-------+\n| 186376|\n| 241022|\n|  55474|\n| 421024|\n|  43367|\n+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532820909945_1121303813","id":"20180728-233509_762404244","dateCreated":"2018-07-28T23:35:09+0000","dateStarted":"2018-07-28T23:36:45+0000","dateFinished":"2018-07-28T23:37:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28548"},{"text":"%spark2.pyspark\n# Splitting the CountRating data\n\n(training,test) = CountRating.randomSplit([0.8,0.2])\n","user":"anonymous","dateUpdated":"2018-07-31T00:03:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532821005144_73925886","id":"20180728-233645_113577989","dateCreated":"2018-07-28T23:36:45+0000","dateStarted":"2018-07-31T00:03:45+0000","dateFinished":"2018-07-31T00:03:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28549"},{"text":"%spark2.pyspark\ntraining.count()","user":"anonymous","dateUpdated":"2018-07-28T23:39:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1403787\n"}]},"apps":[],"jobName":"paragraph_1532821166092_577793703","id":"20180728-233926_315794366","dateCreated":"2018-07-28T23:39:26+0000","dateStarted":"2018-07-28T23:39:35+0000","dateFinished":"2018-07-28T23:40:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28550"},{"text":"%spark2.pyspark\ntest.count()","user":"anonymous","dateUpdated":"2018-07-28T23:40:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"350294\n"}]},"apps":[],"jobName":"paragraph_1532821175480_1371546008","id":"20180728-233935_8886969","dateCreated":"2018-07-28T23:39:35+0000","dateStarted":"2018-07-28T23:40:13+0000","dateFinished":"2018-07-28T23:40:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28551"},{"text":"%spark2.pyspark\n# 1. Build the recommendation model using Alternating Least Squares\n\n# Call the ALS.train mehod to train the model\n\nfrom pyspark.mllib.recommendation import ALS, MatrixFactorizationModel, Rating\n\nrank = 10\nnumIterations = 10\nmodel = ALS.trainImplicit(CountRating, rank, numIterations, alpha=0.01)","user":"anonymous","dateUpdated":"2018-07-31T00:03:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532821190878_-1366110982","id":"20180728-233950_933763324","dateCreated":"2018-07-28T23:39:50+0000","dateStarted":"2018-07-31T00:03:58+0000","dateFinished":"2018-07-31T00:06:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28552"},{"text":"%spark2.pyspark\nmodel\n","user":"anonymous","dateUpdated":"2018-07-29T00:10:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.mllib.recommendation.MatrixFactorizationModel object at 0x7f12aa706850>\n"}]},"apps":[],"jobName":"paragraph_1532822744316_-374779988","id":"20180729-000544_917471578","dateCreated":"2018-07-29T00:05:44+0000","dateStarted":"2018-07-29T00:10:16+0000","dateFinished":"2018-07-29T00:10:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28553"},{"text":"%spark2.pyspark\n# Evaluate the model on training data\n\ntestdata = test.map(lambda r: (r[0],r[1]))\n\ntype(testdata)","user":"anonymous","dateUpdated":"2018-07-31T00:04:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n"}]},"apps":[],"jobName":"paragraph_1532822968218_1152979629","id":"20180729-000928_2024491531","dateCreated":"2018-07-29T00:09:28+0000","dateStarted":"2018-07-31T00:04:07+0000","dateFinished":"2018-07-31T00:06:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28554"},{"text":"%spark2.pyspark\ntestdata.take(5)","user":"anonymous","dateUpdated":"2018-07-29T00:11:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(2866, 90950), (2866, 83908), (3997, 137454), (4101, 376365), (4101, 320620)]\n"}]},"apps":[],"jobName":"paragraph_1532822964704_915204809","id":"20180729-000924_1803926636","dateCreated":"2018-07-29T00:09:24+0000","dateStarted":"2018-07-29T00:11:06+0000","dateFinished":"2018-07-29T00:11:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28555"},{"text":"%spark2.pyspark\n# Making predictions\n\npred_ind = model.predict(2866, 90950)\npred_ind","user":"anonymous","dateUpdated":"2018-07-31T00:06:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1.6660148592219493e-14\n"}]},"apps":[],"jobName":"paragraph_1532822961108_1167969512","id":"20180729-000921_1182479761","dateCreated":"2018-07-29T00:09:21+0000","dateStarted":"2018-07-31T00:06:00+0000","dateFinished":"2018-07-31T00:06:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28556"},{"text":"%spark2.pyspark\nmodel.predictAll(testdata).map(lambda r: ((r[0], r[1]),r[2])).take(5)\n","user":"anonymous","dateUpdated":"2018-07-29T00:14:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[((182316, 141578), 9.360027964671747e-13), ((182316, 453394), 1.6839190168335928e-09), ((1174034, 405862), 1.5333713377778234e-05), ((1174034, 332909), 6.701442390861636e-08), ((449586, 412676), 7.436301929458929e-07)]\n"}]},"apps":[],"jobName":"paragraph_1532822955049_-1536430507","id":"20180729-000915_507334772","dateCreated":"2018-07-29T00:09:15+0000","dateStarted":"2018-07-29T00:14:17+0000","dateFinished":"2018-07-29T00:15:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28557"},{"text":"%spark2.pyspark\n# Recommend Products For Users method to generate the top N item recommendations for users\n\nrecommendItemsToUsers = model.recommendProductsForUsers(10)\n","user":"anonymous","dateUpdated":"2018-07-29T00:37:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532822948841_-1571457981","id":"20180729-000908_886453244","dateCreated":"2018-07-29T00:09:08+0000","dateStarted":"2018-07-29T00:17:57+0000","dateFinished":"2018-07-29T00:17:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28558"},{"text":"%spark2.pyspark\nrecommendItemsToUsers.take(1)\n","user":"anonymous","dateUpdated":"2018-07-29T00:18:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(637100, (Rating(user=637100, product=119736, rating=0.005223899146737956), Rating(user=637100, product=461686, rating=0.0023576194790546536), Rating(user=637100, product=89323, rating=0.0018385901926089086), Rating(user=637100, product=329133, rating=0.0016680327341917545), Rating(user=637100, product=456056, rating=0.0016493104816850334), Rating(user=637100, product=338395, rating=0.0015658005422669505), Rating(user=637100, product=248455, rating=0.0013883330325328554), Rating(user=637100, product=190000, rating=0.001352606204599175), Rating(user=637100, product=174724, rating=0.0013474394347564613), Rating(user=637100, product=7943, rating=0.0013246638674322487)))]\n"}]},"apps":[],"jobName":"paragraph_1532823477019_720244909","id":"20180729-001757_1723799723","dateCreated":"2018-07-29T00:17:57+0000","dateStarted":"2018-07-29T00:18:07+0000","dateFinished":"2018-07-29T02:07:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28559"},{"text":"%spark2.pyspark\nrecommendUsersToProducts = model.recommendUsersForProducts(10)","user":"anonymous","dateUpdated":"2018-07-31T00:05:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532823487328_602157645","id":"20180729-001807_1168560751","dateCreated":"2018-07-29T00:18:07+0000","dateStarted":"2018-07-31T00:06:01+0000","dateFinished":"2018-07-31T00:06:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28560"},{"text":"%spark2.pyspark\nrecommendUsersToProducts.take(1)","user":"anonymous","dateUpdated":"2018-07-31T00:06:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(185012, (Rating(user=1150086, product=185012, rating=3.9819698650934155e-06), Rating(user=416496, product=185012, rating=2.597633650136737e-06), Rating(user=530559, product=185012, rating=2.5946297378327828e-06), Rating(user=816229, product=185012, rating=2.5009509376204212e-06), Rating(user=388556, product=185012, rating=1.8932917814169548e-06), Rating(user=163561, product=185012, rating=1.5923644765318703e-06), Rating(user=286616, product=185012, rating=1.539282245279953e-06), Rating(user=684514, product=185012, rating=1.5258517524466915e-06), Rating(user=152963, product=185012, rating=1.4641960065364423e-06), Rating(user=776534, product=185012, rating=1.4395471554589254e-06)))]\n"}]},"apps":[],"jobName":"paragraph_1532995532066_-1636955046","id":"20180731-000532_162782237","dateCreated":"2018-07-31T00:05:32+0000","dateStarted":"2018-07-31T00:06:18+0000","dateFinished":"2018-07-31T02:16:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28561"},{"text":"%spark2.pyspark\nproductFeatures = model.productFeatures().collect()\n","user":"anonymous","dateUpdated":"2018-07-29T09:23:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532856159931_62357933","id":"20180729-092239_1224090008","dateCreated":"2018-07-29T09:22:39+0000","dateStarted":"2018-07-29T09:23:15+0000","dateFinished":"2018-07-29T09:23:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28562"},{"text":"%spark2.pyspark\nproductFeatures_1 = sqlContext.createDataFrame(productFeatures)\nmodel.userFeatures().collect()\nproductFeatures_1.show(3)\n","user":"anonymous","dateUpdated":"2018-07-29T09:25:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+\n| _1|                  _2|\n+---+--------------------+\n|  6|[-9.7645797723089...|\n| 16|[-4.3652999011101...|\n| 22|[-1.2225323189340...|\n+---+--------------------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532856152445_320509121","id":"20180729-092232_31097979","dateCreated":"2018-07-29T09:22:32+0000","dateStarted":"2018-07-29T09:25:07+0000","dateFinished":"2018-07-29T09:25:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28563"},{"text":"%spark2.pyspark\nfirst_product = model.productFeatures().take(1)[0]\nlatents = first_product[1]\nlen(latents)","user":"anonymous","dateUpdated":"2018-07-29T09:25:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]},"apps":[],"jobName":"paragraph_1532856317987_-908315925","id":"20180729-092517_834363949","dateCreated":"2018-07-29T09:25:17+0000","dateStarted":"2018-07-29T09:25:48+0000","dateFinished":"2018-07-29T09:25:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28564"},{"text":"%spark2.pyspark\n# userFeatures\n\nfirst_user = model.userFeatures().take(1)[0]\nlatents = first_user[1]\nlen(latents)","user":"anonymous","dateUpdated":"2018-07-29T09:26:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]},"apps":[],"jobName":"paragraph_1532856313351_442552788","id":"20180729-092513_1635720730","dateCreated":"2018-07-29T09:25:13+0000","dateStarted":"2018-07-29T09:26:12+0000","dateFinished":"2018-07-29T09:26:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28565"},{"text":"%spark2.pyspark\nuserFeatures = model.userFeatures().collect()\nuserFeatures_1 = sqlContext.createDataFrame(userFeatures)\nuserFeatures_1.show(2)","user":"anonymous","dateUpdated":"2018-07-29T09:26:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+\n| _1|                  _2|\n+---+--------------------+\n|  0|[1.02194735518423...|\n|  2|[4.18885378167033...|\n+---+--------------------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532856221342_-48557019","id":"20180729-092341_1230257101","dateCreated":"2018-07-29T09:23:41+0000","dateStarted":"2018-07-29T09:26:36+0000","dateFinished":"2018-07-29T09:27:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28566"},{"text":"%spark2.pyspark\npredictions = model.predictAll(testdata).map(lambda r: ((r[0], r[1]),r[2]))\ntype(predictions)","user":"anonymous","dateUpdated":"2018-07-29T09:35:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n"}]},"apps":[],"jobName":"paragraph_1532856863961_1311484894","id":"20180729-093423_562104182","dateCreated":"2018-07-29T09:34:23+0000","dateStarted":"2018-07-29T09:35:48+0000","dateFinished":"2018-07-29T09:36:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28567"},{"text":"%spark2.pyspark\n# Calculate rmse\nfrom math import sqrt\n\nratesAndPreds = CountRating.map(lambda r: ((r[0],r[1]), r[2])).join(predictions)\n","user":"anonymous","dateUpdated":"2018-07-29T09:36:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532856409782_1573603996","id":"20180729-092649_1572629692","dateCreated":"2018-07-29T09:26:49+0000","dateStarted":"2018-07-29T09:36:42+0000","dateFinished":"2018-07-29T09:36:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28568"},{"text":"%spark2.pyspark\nratesAndPreds.take(5)","user":"anonymous","dateUpdated":"2018-07-29T09:36:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[((100417, 11001), (1.0, 1.0741786558519472e-15)), ((348522, 976), (1.0, 5.492003741511924e-12)), ((348522, 976), (1.0, 5.492003741511924e-12)), ((1027606, 43568), (1.0, 9.780988911393504e-07)), ((1165148, 85774), (1.0, 0.08382794911641386))]\n"}]},"apps":[],"jobName":"paragraph_1532856406682_1190394091","id":"20180729-092646_1924888875","dateCreated":"2018-07-29T09:26:46+0000","dateStarted":"2018-07-29T09:36:55+0000","dateFinished":"2018-07-29T09:38:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28569"},{"text":"%spark2.pyspark\nMeanSquareError = ratesAndPreds.map(lambda r: (r[1][0]-r[1][1])**2).mean()\n\nprint(\"MeanSquareError = \" + str(MeanSquareError))","user":"anonymous","dateUpdated":"2018-07-29T09:39:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"MeanSquareError = 209.955947795\n"}]},"apps":[],"jobName":"paragraph_1532856403266_-560982902","id":"20180729-092643_1020873174","dateCreated":"2018-07-29T09:26:43+0000","dateStarted":"2018-07-29T09:39:59+0000","dateFinished":"2018-07-29T09:40:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28570"},{"text":"%spark2.pyspark\n# Root Mean Square Error\n\nfrom math import sqrt\nrmse = sqrt(MeanSquareError)\nprint(\"Root_Mean_Square_Error = \" + str(rmse))\n","user":"anonymous","dateUpdated":"2018-07-29T09:42:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Root_Mean_Square_Error = 14.489856721\n"}]},"apps":[],"jobName":"paragraph_1532857299310_-206352806","id":"20180729-094139_430533134","dateCreated":"2018-07-29T09:41:39+0000","dateStarted":"2018-07-29T09:42:03+0000","dateFinished":"2018-07-29T09:42:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28571"},{"text":"%spark2.pyspark\n# 2.  Model Evluation and Selection with Hyper Parameter Tuning\n\ndf = sqlContext.createDataFrame(CountRating)\n\ntype(df)","user":"anonymous","dateUpdated":"2018-07-29T09:45:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.sql.dataframe.DataFrame'>\n"}]},"apps":[],"jobName":"paragraph_1532856483285_-1851137909","id":"20180729-092803_1834151664","dateCreated":"2018-07-29T09:28:03+0000","dateStarted":"2018-07-29T09:45:30+0000","dateFinished":"2018-07-29T09:45:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28572"},{"text":"%spark2.pyspark\ndf.show(5)","user":"anonymous","dateUpdated":"2018-07-29T09:45:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+------+\n|user|product|rating|\n+----+-------+------+\n| 496| 269803|   1.0|\n| 496| 395920|   1.0|\n|1238|  76426|   1.0|\n|1238|  76426|   1.0|\n|1238|  76426|   1.0|\n+----+-------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532856496569_51860799","id":"20180729-092816_1371474640","dateCreated":"2018-07-29T09:28:16+0000","dateStarted":"2018-07-29T09:45:33+0000","dateFinished":"2018-07-29T09:45:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28573"},{"text":"%spark2.pyspark\n# Split the input data into separate training and test datasets\n\n(training, test) = df.randomSplit([0.8,0.2])\n","user":"anonymous","dateUpdated":"2018-07-29T09:45:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532856492953_-1708750168","id":"20180729-092812_612587088","dateCreated":"2018-07-29T09:28:12+0000","dateStarted":"2018-07-29T09:45:38+0000","dateFinished":"2018-07-29T09:45:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28574"},{"text":"%spark2.pyspark\ntraining.count()","user":"anonymous","dateUpdated":"2018-07-29T09:45:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1403894\n"}]},"apps":[],"jobName":"paragraph_1532856488798_-1350179517","id":"20180729-092808_1276634571","dateCreated":"2018-07-29T09:28:08+0000","dateStarted":"2018-07-29T09:45:40+0000","dateFinished":"2018-07-29T09:46:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28575"},{"text":"%spark2.pyspark\ntest.count()","user":"anonymous","dateUpdated":"2018-07-29T09:45:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"350187\n"}]},"apps":[],"jobName":"paragraph_1532856395854_-625251293","id":"20180729-092635_560299345","dateCreated":"2018-07-29T09:26:35+0000","dateStarted":"2018-07-29T09:45:46+0000","dateFinished":"2018-07-29T09:46:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28576"},{"text":"%spark2.pyspark\n# Apply implicit parameter to the data\n\nfrom pyspark.ml.recommendation import ALS\nals = ALS(implicitPrefs=True, userCol=\"user\", itemCol=\"product\", ratingCol=\"rating\", coldStartStrategy=\"drop\")\n","user":"anonymous","dateUpdated":"2018-07-29T09:46:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532856582209_77409113","id":"20180729-092942_1630148843","dateCreated":"2018-07-29T09:29:42+0000","dateStarted":"2018-07-29T09:46:10+0000","dateFinished":"2018-07-29T09:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28577"},{"text":"%spark2.pyspark\nals","user":"anonymous","dateUpdated":"2018-07-29T09:46:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ALS_4ce5ad5e1cf6ca5e84d9\n"}]},"apps":[],"jobName":"paragraph_1532856681113_401075406","id":"20180729-093121_1297196177","dateCreated":"2018-07-29T09:31:21+0000","dateStarted":"2018-07-29T09:46:40+0000","dateFinished":"2018-07-29T09:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28578"},{"text":"%spark2.pyspark\nals.explainParams()","user":"anonymous","dateUpdated":"2018-07-29T09:44:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\"alpha: alpha for implicit preference (default: 1.0)\\ncheckpointInterval: set checkpoint interval (>= 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations. Note: this setting will be ignored if the checkpoint directory is not set in the SparkContext. (default: 10)\\ncoldStartStrategy: strategy for dealing with unknown or new users/items at prediction time. This may be useful in cross-validation or production scenarios, for handling user/item ids the model has not seen in the training data. Supported values: 'nan', 'drop'. (default: nan, current: drop)\\nfinalStorageLevel: StorageLevel for ALS model factors. (default: MEMORY_AND_DISK)\\nimplicitPrefs: whether to use implicit preference (default: False, current: True)\\nintermediateStorageLevel: StorageLevel for intermediate datasets. Cannot be 'NONE'. (default: MEMORY_AND_DISK)\\nitemCol: column name for item ids. Ids must be within the integer value range. (default: item, current: product)\\nmaxIter: max number of iterations (>= 0). (default: 10)\\nnonnegative: whether to use nonnegative constraint for least squares (default: False)\\nnumItemBlocks: number of item blocks (default: 10)\\nnumUserBlocks: number of user blocks (default: 10)\\npredictionCol: prediction column name. (default: prediction)\\nrank: rank of the factorization (default: 10)\\nratingCol: column name for ratings (default: rating, current: rating)\\nregParam: regularization parameter (>= 0). (default: 0.1)\\nseed: random seed. (default: 593367982098446717)\\nuserCol: column name for user ids. Ids must be within the integer value range. (default: user, current: user)\"\n"}]},"apps":[],"jobName":"paragraph_1532856685423_1982393386","id":"20180729-093125_1476355061","dateCreated":"2018-07-29T09:31:25+0000","dateStarted":"2018-07-29T09:44:17+0000","dateFinished":"2018-07-29T09:44:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28579"},{"text":"%spark2.pyspark\nfrom pyspark.ml import Pipeline\n\npipeline = Pipeline(stages=[als])","user":"anonymous","dateUpdated":"2018-07-29T09:46:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532856719348_814157808","id":"20180729-093159_1271046875","dateCreated":"2018-07-29T09:31:59+0000","dateStarted":"2018-07-29T09:46:40+0000","dateFinished":"2018-07-29T09:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28580"},{"text":"%spark2.pyspark\ntype(pipeline)","user":"anonymous","dateUpdated":"2018-07-29T09:44:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.ml.pipeline.Pipeline'>\n"}]},"apps":[],"jobName":"paragraph_1532856729953_2061159641","id":"20180729-093209_1705990970","dateCreated":"2018-07-29T09:32:09+0000","dateStarted":"2018-07-29T09:44:33+0000","dateFinished":"2018-07-29T09:44:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28581"},{"text":"%spark2.pyspark\n# Set the params\n\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\n\nparamImplicit = ParamGridBuilder()\\\n.addGrid(als.rank,[5,10])\\\n.addGrid(als.maxIter,[5,10])\\\n.addGrid(als.regParam,[1.0,5.0])\\\n.build()\n","user":"anonymous","dateUpdated":"2018-07-29T09:46:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532856762011_-1335003576","id":"20180729-093242_1721272374","dateCreated":"2018-07-29T09:32:42+0000","dateStarted":"2018-07-29T09:46:40+0000","dateFinished":"2018-07-29T09:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28582"},{"text":"%spark2.pyspark\nfrom pyspark.ml.evaluation import RegressionEvaluator\n\nevaluatoR = RegressionEvaluator(metricName='rmse', labelCol='rating')\n","user":"anonymous","dateUpdated":"2018-07-29T09:46:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532857071808_-1393624971","id":"20180729-093751_537231161","dateCreated":"2018-07-29T09:37:51+0000","dateStarted":"2018-07-29T09:46:40+0000","dateFinished":"2018-07-29T09:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28583"},{"text":"%spark2.pyspark\n# Fit the estimator using params\n\ncvImplicit = CrossValidator(estimator=als, estimatorParamMaps=paramImplicit, evaluator=evaluatoR, numFolds=3)\n","user":"anonymous","dateUpdated":"2018-07-29T09:46:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532857067629_1258849271","id":"20180729-093747_1271936691","dateCreated":"2018-07-29T09:37:47+0000","dateStarted":"2018-07-29T09:46:40+0000","dateFinished":"2018-07-29T09:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28584"},{"text":"%spark2.pyspark\ncvModel = cvImplicit.fit(training)\n","user":"anonymous","dateUpdated":"2018-07-29T09:46:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532857063876_1855194742","id":"20180729-093743_982824652","dateCreated":"2018-07-29T09:37:43+0000","dateStarted":"2018-07-29T09:46:40+0000","dateFinished":"2018-07-29T10:24:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28585"},{"text":"%spark2.pyspark\n# Fit the model\n\n# Select the model produced by the best performance set of params\npreds = cvModel.bestModel.transform(test)\n","user":"anonymous","dateUpdated":"2018-07-29T10:15:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532857132011_-130955702","id":"20180729-093852_1546716825","dateCreated":"2018-07-29T09:38:52+0000","dateStarted":"2018-07-29T10:15:16+0000","dateFinished":"2018-07-29T10:24:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28586"},{"text":"%spark2.pyspark\nevaluator = RegressionEvaluator(metricName='rmse', labelCol='rating', predictionCol='prediction')\n","user":"anonymous","dateUpdated":"2018-07-29T17:15:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532857235281_-220496571","id":"20180729-094035_906167842","dateCreated":"2018-07-29T09:40:35+0000","dateStarted":"2018-07-29T17:15:28+0000","dateFinished":"2018-07-29T17:15:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28587"},{"text":"%spark2.pyspark\n# Find Root Mean Square Error\n\nrmse = evaluator.evaluate(preds)\n","user":"anonymous","dateUpdated":"2018-07-29T17:15:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532857246232_807198390","id":"20180729-094046_1335797558","dateCreated":"2018-07-29T09:40:46+0000","dateStarted":"2018-07-29T17:15:34+0000","dateFinished":"2018-07-29T17:16:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28588"},{"text":"%spark2.pyspark\nprint(\"Root-mean-square error =\"+str(rmse))\n","user":"anonymous","dateUpdated":"2018-07-29T17:24:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Root-mean-square error =1.10259915379\n"}]},"apps":[],"jobName":"paragraph_1532857271281_55044939","id":"20180729-094111_404881451","dateCreated":"2018-07-29T09:41:11+0000","dateStarted":"2018-07-29T17:24:20+0000","dateFinished":"2018-07-29T17:24:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28589"},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2018-07-29T17:24:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532885060542_-658415492","id":"20180729-172420_1757862311","dateCreated":"2018-07-29T17:24:20+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:28590"}],"name":"CountWiseVisitor","id":"2DJP1CZMV","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}