{"paragraphs":[{"text":"%spark2.pyspark\n\n# Load Category data\n\ndata = sc.textFile('/user/maria_dev/CountWiseVisitorTime.csv')","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112682_274310155","id":"20180807-192130_1587022610","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:23+0000","dateFinished":"2018-08-08T00:14:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12140"},{"text":"%spark2.pyspark\ndata.first()","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'visitorid,itemid,event'\n"}]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192143_1015219269","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:23+0000","dateFinished":"2018-08-08T00:14:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12141"},{"text":"%spark2.pyspark\ndata.count()","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1754082\n"}]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192629_603043219","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:23+0000","dateFinished":"2018-08-08T00:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12142"},{"text":"%spark2.pyspark\nheader = data.first()","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192530_1064831360","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:24+0000","dateFinished":"2018-08-08T00:14:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12143"},{"text":"%spark2.pyspark\ndf= data.filter(lambda x: x!=header)","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192545_449231498","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:31+0000","dateFinished":"2018-08-08T00:14:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12144"},{"text":"%spark2.pyspark\ndf.count()","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1754081\n"}]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192622_1666543927","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:31+0000","dateFinished":"2018-08-08T00:14:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12145"},{"text":"%spark2.pyspark\n# Ranking systems evaluation\n\nfrom pyspark.mllib.recommendation import ALS, Rating\nfrom pyspark.mllib.evaluation import RegressionMetrics, RankingMetrics","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192647_2019202310","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:31+0000","dateFinished":"2018-08-08T00:14:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12146"},{"text":"%spark2.pyspark\ndef parseLine(line):\n    fields = line.split(',')\n    return Rating(int(fields[0]), int(fields[1]), float(fields[2]) - 1.5)\nratings = df.map(lambda r: parseLine(r))","user":"anonymous","dateUpdated":"2018-08-08T00:14:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-192936_397168557","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:39+0000","dateFinished":"2018-08-08T00:14:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12147"},{"text":"%spark2.pyspark\n# Train a model on to predict user-product ratings\nmodel = ALS.train(ratings, 10, 10, 0.01)","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112683_273925406","id":"20180807-193059_1177127279","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:39+0000","dateFinished":"2018-08-08T00:16:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12148"},{"text":"%spark2.pyspark\n# Get predicted ratings on all existing user-product pairs\ntestData = ratings.map(lambda p: (p.user, p.product))","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193216_1269538120","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:14:39+0000","dateFinished":"2018-08-08T00:16:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12149"},{"text":"%spark2.pyspark\npredictions = model.predictAll(testData).map(lambda r: ((r.user, r.product), r.rating))","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193253_1874426669","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:16:18+0000","dateFinished":"2018-08-08T00:16:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12150"},{"text":"%spark2.pyspark\nratingsTuple = ratings.map(lambda r: ((r.user, r.product), r.rating))\n","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193309_1801358419","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:16:18+0000","dateFinished":"2018-08-08T00:16:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12151"},{"text":"%spark2.pyspark\nratingsTuple.first()","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"((496, 269803), -0.5)\n"}]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-213352_1226386360","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:16:43+0000","dateFinished":"2018-08-08T00:16:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12152"},{"text":"%spark2.pyspark\nscoreAndLabels = predictions.join(ratingsTuple).map(lambda tup: tup[1])","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193332_1042580931","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:16:43+0000","dateFinished":"2018-08-08T00:16:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12153"},{"text":"%spark2.pyspark\nscoreAndLabels.take(2)","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(-0.4941928189181514, -0.5), (-0.4941928189181514, -0.5)]\n"}]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-213428_1621656814","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:16:43+0000","dateFinished":"2018-08-08T00:18:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12154"},{"text":"%spark2.pyspark\n# Instantiate regression metrics to compare predicted and actual ratings\nmetrics = RegressionMetrics(scoreAndLabels)\n","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193337_978695208","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:16:44+0000","dateFinished":"2018-08-08T00:18:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12155"},{"text":"%spark2.pyspark\n# Root mean squared error\nprint(\"RMSE = %s\" % metrics.rootMeanSquaredError)\n","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE = 0.264504154662\n"}]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193353_206953557","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:18:51+0000","dateFinished":"2018-08-08T00:20:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12156"},{"text":"%spark2.pyspark\n# R-squared\nprint(\"R-squared = %s\" % metrics.r2)","user":"anonymous","dateUpdated":"2018-08-08T00:14:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"R-squared = 0.379424878877\n"}]},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193410_587870629","dateCreated":"2018-08-07T23:21:52+0000","dateStarted":"2018-08-08T00:18:52+0000","dateFinished":"2018-08-08T00:20:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12157"},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2018-08-07T23:52:03+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533684112684_272001662","id":"20180807-193429_156599751","dateCreated":"2018-08-07T23:21:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:12158"}],"name":"AUC VisitorGtOne","id":"2DNJAGR79","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}