{"paragraphs":[{"text":"%spark2.pyspark\n\n# Load Category data\n\ndata = sc.textFile('/user/maria_dev/CountGt2VisitorsDistinct.csv')","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769715_1381840627","id":"20180807-192130_1587022610","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13240","user":"anonymous","dateFinished":"2018-08-08T13:26:30+0000","dateStarted":"2018-08-08T13:26:30+0000"},{"text":"%spark2.pyspark\ndata.first()","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'visitorid,itemid,event'\n"}]},"apps":[],"jobName":"paragraph_1533734769715_1381840627","id":"20180807-192143_1015219269","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13241","user":"anonymous","dateFinished":"2018-08-08T13:26:31+0000","dateStarted":"2018-08-08T13:26:30+0000"},{"text":"%spark2.pyspark\ndata.count()","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"881846\n"}]},"apps":[],"jobName":"paragraph_1533734769715_1381840627","id":"20180807-192629_603043219","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13242","user":"anonymous","dateFinished":"2018-08-08T13:26:36+0000","dateStarted":"2018-08-08T13:26:30+0000"},{"text":"%spark2.pyspark\nheader = data.first()","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-192530_1064831360","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13243","user":"anonymous","dateFinished":"2018-08-08T13:26:36+0000","dateStarted":"2018-08-08T13:26:31+0000"},{"text":"%spark2.pyspark\ndf= data.filter(lambda x: x!=header)","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-192545_449231498","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13244","user":"anonymous","dateFinished":"2018-08-08T13:26:36+0000","dateStarted":"2018-08-08T13:26:36+0000"},{"text":"%spark2.pyspark\ndf.count()","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"881845\n"}]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-192622_1666543927","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13245","user":"anonymous","dateFinished":"2018-08-08T13:26:44+0000","dateStarted":"2018-08-08T13:26:36+0000"},{"text":"%spark2.pyspark\n# Ranking systems evaluation\n\nfrom pyspark.mllib.recommendation import ALS, Rating\nfrom pyspark.mllib.evaluation import RegressionMetrics, RankingMetrics","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-192647_2019202310","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13246","user":"anonymous","dateFinished":"2018-08-08T13:26:44+0000","dateStarted":"2018-08-08T13:26:37+0000"},{"text":"%spark2.pyspark\ndef parseLine(line):\n    fields = line.split(',')\n    return Rating(int(fields[0]), int(fields[1]), float(fields[2]) - 1.5)\nratings = df.map(lambda r: parseLine(r))","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-192936_397168557","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13247","user":"anonymous","dateFinished":"2018-08-08T13:26:44+0000","dateStarted":"2018-08-08T13:26:44+0000"},{"text":"%spark2.pyspark\n# Train a model on to predict user-product ratings\nmodel = ALS.train(ratings, 10, 10, 0.01)","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-193059_1177127279","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13248","user":"anonymous","dateFinished":"2018-08-08T13:27:52+0000","dateStarted":"2018-08-08T13:26:44+0000"},{"text":"%spark2.pyspark\n# Get predicted ratings on all existing user-product pairs\ntestData = ratings.map(lambda p: (p.user, p.product))","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769716_1379916882","id":"20180807-193216_1269538120","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13249","user":"anonymous","dateFinished":"2018-08-08T13:27:52+0000","dateStarted":"2018-08-08T13:26:45+0000"},{"text":"%spark2.pyspark\npredictions = model.predictAll(testData).map(lambda r: ((r.user, r.product), r.rating))","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769717_1379532133","id":"20180807-193253_1874426669","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13250","user":"anonymous","dateFinished":"2018-08-08T13:28:12+0000","dateStarted":"2018-08-08T13:27:53+0000"},{"text":"%spark2.pyspark\nratingsTuple = ratings.map(lambda r: ((r.user, r.product), r.rating))\n","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769717_1379532133","id":"20180807-193309_1801358419","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13251","user":"anonymous","dateFinished":"2018-08-08T13:28:12+0000","dateStarted":"2018-08-08T13:27:53+0000"},{"text":"%spark2.pyspark\nratingsTuple.first()","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"((1238, 76426), -0.5)\n"}]},"apps":[],"jobName":"paragraph_1533734769717_1379532133","id":"20180807-213352_1226386360","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13252","user":"anonymous","dateFinished":"2018-08-08T13:28:12+0000","dateStarted":"2018-08-08T13:28:12+0000"},{"text":"%spark2.pyspark\nscoreAndLabels = predictions.join(ratingsTuple).map(lambda tup: tup[1])","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769717_1379532133","id":"20180807-193332_1042580931","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13253","user":"anonymous","dateFinished":"2018-08-08T13:28:12+0000","dateStarted":"2018-08-08T13:28:12+0000"},{"text":"%spark2.pyspark\nscoreAndLabels.take(2)","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(-0.4826231697576677, -0.5), (-0.46304740799566446, -0.5)]\n"}]},"apps":[],"jobName":"paragraph_1533734769718_1380686380","id":"20180807-213428_1621656814","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13254","user":"anonymous","dateFinished":"2018-08-08T13:29:34+0000","dateStarted":"2018-08-08T13:28:12+0000"},{"text":"%spark2.pyspark\n# Instantiate regression metrics to compare predicted and actual ratings\nmetrics = RegressionMetrics(scoreAndLabels)\n","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533734769718_1380686380","id":"20180807-193337_978695208","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13255","user":"anonymous","dateFinished":"2018-08-08T13:29:35+0000","dateStarted":"2018-08-08T13:28:13+0000"},{"text":"%spark2.pyspark\n# Root mean squared error\nprint(\"RMSE = %s\" % metrics.rootMeanSquaredError)\n","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE = 0.366952337116\n"}]},"apps":[],"jobName":"paragraph_1533734769718_1380686380","id":"20180807-193353_206953557","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13256","user":"anonymous","dateFinished":"2018-08-08T13:30:12+0000","dateStarted":"2018-08-08T13:29:35+0000"},{"text":"%spark2.pyspark\n# R-squared\nprint(\"R-squared = %s\" % metrics.r2)","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"R-squared = 0.525754066486\n"}]},"apps":[],"jobName":"paragraph_1533734769718_1380686380","id":"20180807-193410_587870629","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13257","user":"anonymous","dateFinished":"2018-08-08T13:30:12+0000","dateStarted":"2018-08-08T13:29:36+0000"},{"text":"%spark2.pyspark\n","dateUpdated":"2018-08-08T13:26:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533734769718_1380686380","id":"20180807-193429_156599751","dateCreated":"2018-08-08T13:26:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13258","user":"anonymous"}],"name":"Model_4 3 Evaluation","id":"2DMHKC9EW","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}