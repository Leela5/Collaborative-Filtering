{"paragraphs":[{"text":"%spark2.pyspark\n\n# Load Category data\n\ndata = sc.textFile('/user/maria_dev/CategoryWiseRec.csv')","user":"anonymous","dateUpdated":"2018-08-07T22:54:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533669690051_671699847","id":"20180807-192130_1587022610","dateCreated":"2018-08-07T19:21:30+0000","dateStarted":"2018-08-07T22:54:51+0000","dateFinished":"2018-08-07T22:54:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4753"},{"text":"%spark2.pyspark\ndata.first()","user":"anonymous","dateUpdated":"2018-08-07T22:54:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'visitorid,categoryid,event'\n"}]},"apps":[],"jobName":"paragraph_1533669703879_-1929572142","id":"20180807-192143_1015219269","dateCreated":"2018-08-07T19:21:43+0000","dateStarted":"2018-08-07T22:54:51+0000","dateFinished":"2018-08-07T22:54:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4754"},{"text":"%spark2.pyspark\ndata.count()","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1502957\n"}]},"apps":[],"jobName":"paragraph_1533669989980_7636925","id":"20180807-192629_603043219","dateCreated":"2018-08-07T19:26:29+0000","dateStarted":"2018-08-07T22:54:52+0000","dateFinished":"2018-08-07T22:55:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4755"},{"text":"%spark2.pyspark\nheader = data.first()","user":"anonymous","dateUpdated":"2018-08-07T22:54:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533669930756_1037717000","id":"20180807-192530_1064831360","dateCreated":"2018-08-07T19:25:30+0000","dateStarted":"2018-08-07T22:54:52+0000","dateFinished":"2018-08-07T22:55:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4756"},{"text":"%spark2.pyspark\ndf= data.filter(lambda x: x!=header)","user":"anonymous","dateUpdated":"2018-08-07T22:54:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533669945414_-1612217241","id":"20180807-192545_449231498","dateCreated":"2018-08-07T19:25:45+0000","dateStarted":"2018-08-07T22:55:02+0000","dateFinished":"2018-08-07T22:55:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4757"},{"text":"%spark2.pyspark\ndf.count()","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1502956\n"}]},"apps":[],"jobName":"paragraph_1533669982287_-1771057240","id":"20180807-192622_1666543927","dateCreated":"2018-08-07T19:26:22+0000","dateStarted":"2018-08-07T22:55:02+0000","dateFinished":"2018-08-07T22:55:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4758"},{"text":"%spark2.pyspark\n# Ranking systems evaluation\n\nfrom pyspark.mllib.recommendation import ALS, Rating\nfrom pyspark.mllib.evaluation import RegressionMetrics, RankingMetrics","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670007417_346078040","id":"20180807-192647_2019202310","dateCreated":"2018-08-07T19:26:47+0000","dateStarted":"2018-08-07T22:55:03+0000","dateFinished":"2018-08-07T22:55:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4759"},{"text":"%spark2.pyspark\ndef parseLine(line):\n    fields = line.split(',')\n    return Rating(int(fields[0]), int(fields[1]), float(fields[2]) - 1.5)\nratings = df.map(lambda r: parseLine(r))","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670176705_996886000","id":"20180807-192936_397168557","dateCreated":"2018-08-07T19:29:36+0000","dateStarted":"2018-08-07T22:55:08+0000","dateFinished":"2018-08-07T22:55:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4760"},{"text":"%spark2.pyspark\n# Train a model on to predict user-product ratings\nmodel = ALS.train(ratings, 10, 10, 0.01)","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533670259516_-419836071","id":"20180807-193059_1177127279","dateCreated":"2018-08-07T19:30:59+0000","dateStarted":"2018-08-07T22:55:08+0000","dateFinished":"2018-08-07T22:56:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4761","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\n# Get predicted ratings on all existing user-product pairs\ntestData = ratings.map(lambda p: (p.user, p.product))","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670336910_-399935874","id":"20180807-193216_1269538120","dateCreated":"2018-08-07T19:32:16+0000","dateStarted":"2018-08-07T22:55:09+0000","dateFinished":"2018-08-07T22:56:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4762"},{"text":"%spark2.pyspark\npredictions = model.predictAll(testData).map(lambda r: ((r.user, r.product), r.rating))","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670373370_45264576","id":"20180807-193253_1874426669","dateCreated":"2018-08-07T19:32:53+0000","dateStarted":"2018-08-07T22:56:55+0000","dateFinished":"2018-08-07T22:57:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4763"},{"text":"%spark2.pyspark\nratingsTuple = ratings.map(lambda r: ((r.user, r.product), r.rating))\n","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670389713_-1949258398","id":"20180807-193309_1801358419","dateCreated":"2018-08-07T19:33:09+0000","dateStarted":"2018-08-07T22:56:55+0000","dateFinished":"2018-08-07T22:57:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4764"},{"text":"%spark2.pyspark\nscoreAndLabels = predictions.join(ratingsTuple).map(lambda tup: tup[1])","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670412301_827336496","id":"20180807-193332_1042580931","dateCreated":"2018-08-07T19:33:32+0000","dateStarted":"2018-08-07T22:57:15+0000","dateFinished":"2018-08-07T22:57:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4765"},{"text":"%spark2.pyspark\n# Instantiate regression metrics to compare predicted and actual ratings\nmetrics = RegressionMetrics(scoreAndLabels)\n","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533670417851_144422523","id":"20180807-193337_978695208","dateCreated":"2018-08-07T19:33:37+0000","dateStarted":"2018-08-07T22:57:15+0000","dateFinished":"2018-08-07T22:57:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4766"},{"text":"%spark2.pyspark\n# Root mean squared error\nprint(\"RMSE = %s\" % metrics.rootMeanSquaredError)\n","user":"anonymous","dateUpdated":"2018-08-07T22:54:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE = 0.285802808109\n"}]},"apps":[],"jobName":"paragraph_1533670433534_-1791618618","id":"20180807-193353_206953557","dateCreated":"2018-08-07T19:33:53+0000","dateStarted":"2018-08-07T22:57:15+0000","dateFinished":"2018-08-07T23:00:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4767"},{"text":"%spark2.pyspark\n# R-squared\nprint(\"R-squared = %s\" % metrics.r2)","user":"anonymous","dateUpdated":"2018-08-07T22:54:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"R-squared = 0.531235132214\n"}]},"apps":[],"jobName":"paragraph_1533670450516_361466875","id":"20180807-193410_587870629","dateCreated":"2018-08-07T19:34:10+0000","dateStarted":"2018-08-07T22:57:16+0000","dateFinished":"2018-08-07T23:00:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4768"},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2018-08-07T20:28:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533670469923_-779097431","id":"20180807-193429_156599751","dateCreated":"2018-08-07T19:34:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4769"}],"name":"AUC","id":"2DM8BDTZG","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}